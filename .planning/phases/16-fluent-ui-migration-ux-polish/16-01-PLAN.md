---
phase: 16-fluent-ui-migration-ux-polish
plan: 01
type: execute
wave: 1
depends_on: []
files_modified:
  - enterprise-work-assistant/src/AssistantDashboard/components/BriefingCard.tsx
  - enterprise-work-assistant/src/AssistantDashboard/components/ConfidenceCalibration.tsx
  - enterprise-work-assistant/src/AssistantDashboard/components/__tests__/BriefingCard.test.tsx
  - enterprise-work-assistant/src/AssistantDashboard/components/__tests__/ConfidenceCalibration.test.tsx
autonomous: true
requirements:
  - UIUX-01
  - UIUX-05
  - UIUX-06

must_haves:
  truths:
    - "BriefingCard renders using Fluent UI Button, Text, Badge, and Card components with zero plain HTML interactive elements"
    - "BriefingCard detail view has a visible Back button (ArrowLeftRegular icon) that navigates back to gallery"
    - "ConfidenceCalibration renders using Fluent UI TabList/Tab for navigation, Text for labels, Badge/Button for interactions"
    - "ConfidenceCalibration empty analytics buckets show 'No data' text instead of misleading '0%' values"
    - "All existing tests pass after migration with updated Fluent UI mocks"
  artifacts:
    - path: "enterprise-work-assistant/src/AssistantDashboard/components/BriefingCard.tsx"
      provides: "Fluent UI BriefingCard with Back button"
      contains: "from \"@fluentui/react-components\""
    - path: "enterprise-work-assistant/src/AssistantDashboard/components/ConfidenceCalibration.tsx"
      provides: "Fluent UI ConfidenceCalibration with empty state handling"
      contains: "from \"@fluentui/react-components\""
  key_links:
    - from: "BriefingCard.tsx"
      to: "@fluentui/react-components"
      via: "import Button, Text, Badge, Card"
      pattern: "import.*Button.*from.*@fluentui/react-components"
    - from: "ConfidenceCalibration.tsx"
      to: "@fluentui/react-components"
      via: "import TabList, Tab, Text, Badge"
      pattern: "import.*TabList.*from.*@fluentui/react-components"
---

<objective>
Migrate BriefingCard and ConfidenceCalibration from plain HTML to Fluent UI v9 components, add Back navigation to BriefingCard detail view, and fix empty analytics buckets to show "No data" instead of misleading 0%.

Purpose: These two components are the largest plain-HTML holdouts in the PCF dashboard. Migrating them brings visual consistency with CardDetail/CardItem/FilterBar (which already use Fluent UI) and addresses three UX gaps from the v2.1 audit.

Output: Two fully migrated components with updated tests.
</objective>

<execution_context>
@/Users/admin/.claude/get-shit-done/workflows/execute-plan.md
@/Users/admin/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/STATE.md
@.planning/ROADMAP.md

@enterprise-work-assistant/src/AssistantDashboard/components/BriefingCard.tsx
@enterprise-work-assistant/src/AssistantDashboard/components/ConfidenceCalibration.tsx
@enterprise-work-assistant/src/AssistantDashboard/components/__tests__/BriefingCard.test.tsx
@enterprise-work-assistant/src/AssistantDashboard/components/__tests__/ConfidenceCalibration.test.tsx

<interfaces>
<!-- Key types and contracts the executor needs. Extracted from codebase. -->

From components/types.ts:
```typescript
export interface BriefingActionItem { rank: number; card_ids: string[]; thread_summary: string; recommended_action: string; urgency_reason: string; related_calendar: string | null; }
export interface BriefingFyiItem { card_ids: string[]; summary: string; category: "MEETING_PREP" | "INFO_UPDATE" | "LOW_PRIORITY"; }
export interface BriefingStaleAlert { card_id: string; summary: string; hours_pending: number; recommended_action: "RESPOND" | "DELEGATE" | "DISMISS"; }
export interface DailyBriefing { briefing_type: "DAILY"; briefing_date: string; total_open_items: number; day_shape: string; action_items: BriefingActionItem[]; fyi_items?: BriefingFyiItem[]; stale_alerts?: BriefingStaleAlert[]; }
export interface AssistantCard { id: string; trigger_type: TriggerType; triage_tier: TriageTier; item_summary: string; /* ... */ card_status: CardStatus; draft_payload: DraftPayload | string | null; created_on: string; card_outcome: CardOutcome; /* ... */ }
```

From components/constants.ts (already uses Fluent tokens):
```typescript
import { tokens } from "@fluentui/react-components";
export const PRIORITY_COLORS: Record<string, string> = { High: tokens.colorPaletteRedBorder2, Medium: tokens.colorPaletteMarigoldBorder2, Low: tokens.colorPaletteGreenBorder2 };
```

From package.json (Fluent UI already installed):
```json
"@fluentui/react-components": "^9.46.0",
"@fluentui/react-icons": "^2.0.245"
```

Established Fluent UI patterns from CardDetail.tsx:
```typescript
import { Button, Badge, Text, Link, Textarea, Spinner, MessageBar, MessageBarBody } from "@fluentui/react-components";
import { ArrowLeftRegular, SendRegular, CopyRegular, DismissRegular, CheckmarkCircleRegular } from "@fluentui/react-icons";
```

Established Fluent UI patterns from CardItem.tsx:
```typescript
import { Card, Badge, Text, tokens } from "@fluentui/react-components";
import { MailRegular, ChatRegular, CalendarRegular, WeatherSunnyRegular, SlideTextRegular, AlertRegular } from "@fluentui/react-icons";
```
</interfaces>
</context>

<tasks>

<task type="auto">
  <name>Task 1: Migrate BriefingCard to Fluent UI with Back button</name>
  <files>
    enterprise-work-assistant/src/AssistantDashboard/components/BriefingCard.tsx
    enterprise-work-assistant/src/AssistantDashboard/components/__tests__/BriefingCard.test.tsx
  </files>
  <action>
Replace all plain HTML elements in BriefingCard.tsx with Fluent UI v9 equivalents. Follow the exact same patterns used in CardDetail.tsx and CardItem.tsx. Preserve all existing functionality and CSS class names for layout.

**Imports to add:**
```typescript
import { Button, Text, Badge, Card, tokens } from "@fluentui/react-components";
import { ArrowLeftRegular, DismissRegular, ChevronDownRegular, ChevronRightRegular, CalendarRegular, ArrowRightRegular } from "@fluentui/react-icons";
```

**Element replacements (BriefingCard component and sub-components):**

1. All `<button>` elements ‚Üí `<Button>` from Fluent UI:
   - "Open card ‚Üí" links: `<Button appearance="transparent" size="small" icon={<ArrowRightRegular />} onClick={...}>Open card</Button>`
   - "Dismiss briefing" button: `<Button appearance="subtle" icon={<DismissRegular />} onClick={...}>Dismiss briefing</Button>`
   - "Open ‚Üí" in StaleAlert: `<Button appearance="transparent" size="small" icon={<ArrowRightRegular />} onClick={...}>Open</Button>`
   - FYI toggle button: `<Button appearance="transparent" icon={fyiExpanded ? <ChevronDownRegular /> : <ChevronRightRegular />} onClick={...}>For Your Information ({count})</Button>`

2. All `<h2>` / `<h3>` elements ‚Üí `<Text>` with appropriate size/weight:
   - `<h2>Daily Briefing</h2>` ‚Üí `<Text as="h2" size={500} weight="semibold" block>Daily Briefing</Text>`
   - `<h3>Overdue Items</h3>` ‚Üí `<Text as="h3" size={400} weight="semibold" block>Overdue Items</Text>`
   - `<h3>Action Items</h3>` ‚Üí `<Text as="h3" size={400} weight="semibold" block>Action Items</Text>`

3. Status/rank indicators ‚Üí `<Badge>`:
   - Rank number `#{item.rank}` ‚Üí `<Badge appearance="filled" size="small">#{item.rank}</Badge>`
   - FYI category ‚Üí `<Badge appearance="outline" size="small">{categoryLabel}</Badge>`
   - Stale hours ‚Üí `<Badge appearance="tint" color="warning" size="small">{hours}h pending</Badge>`

4. Descriptive `<span>` / `<p>` elements ‚Üí `<Text>`:
   - Error message ‚Üí `<Text block>Unable to parse...</Text>`
   - Day shape narrative ‚Üí `<Text block size={300}>{briefing.day_shape}</Text>`
   - Date/count spans ‚Üí `<Text size={200}>{briefing.briefing_date}</Text>` and `<Badge appearance="outline" size="small">{count} open items</Badge>`

5. Calendar icon text "üìÖ" ‚Üí `<CalendarRegular />` from `@fluentui/react-icons`

6. **Add Back button (UIUX-05):** Add an `onBack` prop to BriefingCardProps. When `onBack` is provided, render a Back button at the top of the card header, using the same pattern as CardDetail:
   ```typescript
   {onBack && (
       <Button appearance="subtle" icon={<ArrowLeftRegular />} onClick={onBack}>
           Back
       </Button>
   )}
   ```
   The `onBack` prop should be optional (`onBack?: () => void`) so existing usage in gallery mode (where no Back is needed) continues to work without changes.

7. Wrap the briefing card outer `<div>` with `<Card>` from Fluent UI for visual consistency with CardItem.

**Update BriefingCard.test.tsx:**
- The test file already mocks `@fluentui/react-components` with simple HTML equivalents. Update the mock to include `Card`, `Text`, `Badge` (already mocked) and add `TabList`/`Tab` if needed.
- Add a test: "renders Back button when onBack is provided" ‚Äî render with `onBack={mockBack}`, click Back, assert `mockBack` was called.
- Add a test: "does not render Back button when onBack is omitted" ‚Äî render without `onBack`, assert no Back button exists.
- Update existing text assertions if the rendered text changes (e.g., button text no longer includes "‚Üí" arrow in text content since it moves to an icon).
  </action>
  <verify>
    <automated>cd enterprise-work-assistant/src && npx jest --config test/jest.config.ts --testPathPattern="BriefingCard" --no-coverage 2>&1 | tail -20</automated>
  </verify>
  <done>BriefingCard.tsx imports from @fluentui/react-components, contains zero plain HTML button/h2/h3 elements, has optional onBack prop with Back button, and all BriefingCard tests pass.</done>
</task>

<task type="auto">
  <name>Task 2: Migrate ConfidenceCalibration to Fluent UI with empty state fix</name>
  <files>
    enterprise-work-assistant/src/AssistantDashboard/components/ConfidenceCalibration.tsx
    enterprise-work-assistant/src/AssistantDashboard/components/__tests__/ConfidenceCalibration.test.tsx
  </files>
  <action>
Replace all plain HTML elements in ConfidenceCalibration.tsx with Fluent UI v9 equivalents. This is the analytics dashboard with 4 tabs.

**Imports to add:**
```typescript
import { Button, Text, Badge, TabList, Tab, tokens } from "@fluentui/react-components";
import { ArrowLeftRegular } from "@fluentui/react-icons";
```

**Element replacements:**

1. **Tab bar** ‚Äî Replace the manual `<div className="calibration-tabs">` with `<TabList>` + `<Tab>`:
   ```typescript
   <TabList selectedValue={activeTab} onTabSelect={(_e, data) => setActiveTab(data.value as typeof activeTab)}>
       <Tab value="accuracy">Confidence Accuracy</Tab>
       <Tab value="triage">Triage Quality</Tab>
       <Tab value="drafts">Draft Quality</Tab>
       <Tab value="senders">Top Senders</Tab>
   </TabList>
   ```
   This replaces the manual `className={... calibration-tab-active ...}` logic with Fluent's built-in selected state.

2. **Back button** ‚Äî Replace `<button className="calibration-back" onClick={onBack}>‚Üê Back to Dashboard</button>` with:
   ```typescript
   <Button appearance="subtle" icon={<ArrowLeftRegular />} onClick={onBack}>Back to Dashboard</Button>
   ```

3. **Header text** ‚Äî Replace `<h2>Agent Performance</h2>` with `<Text as="h2" size={500} weight="semibold" block>Agent Performance</Text>`

4. **Stat cards** ‚Äî Replace `<div className="calibration-stat-card">` pattern with `<Card>` from Fluent UI (import it). Each stat card:
   ```typescript
   <Card className="calibration-stat-card">
       <Text size={600} weight="bold" block>{value}</Text>
       <Text size={300} weight="semibold" block>{label}</Text>
       <Text size={200} style={{ color: tokens.colorNeutralForeground3 }} block>{detail}</Text>
   </Card>
   ```

5. **Accuracy rate badges** ‚Äî Replace `<span className="calibration-good/ok/poor">` with `<Badge>`:
   ```typescript
   <Badge appearance="filled" color={rate >= 70 ? "success" : rate >= 40 ? "warning" : "danger"} size="small">{rate}%</Badge>
   ```

6. **Table elements** ‚Äî Keep `<table>`, `<thead>`, `<tbody>`, `<tr>`, `<th>`, `<td>` as-is. Fluent UI v9 does not have a Table component that maps 1:1 to these; the HTML table elements are acceptable for tabular data display. Apply Fluent tokens for styling where inline styles exist.

7. **Description paragraphs** ‚Äî Replace `<p className="calibration-description">` with `<Text block size={300} style={{ color: tokens.colorNeutralForeground2 }}>`.

8. **Sample count** ‚Äî Replace `<span className="calibration-sample">` with `<Badge appearance="outline" size="small">`.

9. **UIUX-06 ‚Äî Empty analytics buckets:**
   In the accuracy tab, when a bucket has `total === 0`, display `<Text size={200} style={{ color: tokens.colorNeutralForeground3 }}>No data</Text>` instead of `0%`. Specifically, in the accuracy map:
   ```typescript
   <td>{b.total === 0 ? <Text size={200} style={{ color: tokens.colorNeutralForeground3 }}>No data</Text> : <Badge ...>{b.accuracy}%</Badge>}</td>
   ```
   Similarly, in the Triage Quality and Draft Quality tabs, when the denominator is 0, show "No data" instead of "0%":
   - `triageStats.fullTotal === 0` ‚Üí show "No data" instead of "0%" for FULL card action rate
   - `triageStats.lightTotal === 0` ‚Üí show "No data" instead of "0%" for LIGHT card dismiss rate
   - `draftStats.total === 0` ‚Üí show "No data" instead of "0%" for sent-as-is rate

**Update ConfidenceCalibration.test.tsx:**
- The test does NOT mock Fluent UI (it renders real components). Update assertions for text changes:
  - "‚Üê Back to Dashboard" becomes just "Back to Dashboard" (arrow is now an icon)
  - Add test: "shows 'No data' instead of 0% for empty accuracy buckets" ‚Äî render with 0 cards, verify "No data" text appears in the accuracy tab instead of "0%"
  - Update the existing "shows 0% rates with no resolved cards" test to expect "No data" text instead of "0%"
  - Tab click assertions should still work since Fluent Tab still renders clickable text
  </action>
  <verify>
    <automated>cd enterprise-work-assistant/src && npx jest --config test/jest.config.ts --testPathPattern="ConfidenceCalibration" --no-coverage 2>&1 | tail -20</automated>
  </verify>
  <done>ConfidenceCalibration.tsx imports from @fluentui/react-components, uses TabList/Tab for tab navigation, Button for back, Card for stat cards, shows "No data" for empty buckets instead of "0%", and all ConfidenceCalibration tests pass.</done>
</task>

</tasks>

<verification>
1. Run all tests: `cd enterprise-work-assistant/src && npx jest --config test/jest.config.ts --no-coverage`
2. Verify zero plain HTML `<button>` elements in BriefingCard.tsx: `grep -c '<button' enterprise-work-assistant/src/AssistantDashboard/components/BriefingCard.tsx` returns 0
3. Verify zero plain HTML `<button>` elements in ConfidenceCalibration.tsx: `grep -c '<button' enterprise-work-assistant/src/AssistantDashboard/components/ConfidenceCalibration.tsx` returns 0
4. Verify BriefingCard has onBack prop: `grep 'onBack' enterprise-work-assistant/src/AssistantDashboard/components/BriefingCard.tsx` finds the prop
5. Verify "No data" text exists in ConfidenceCalibration: `grep 'No data' enterprise-work-assistant/src/AssistantDashboard/components/ConfidenceCalibration.tsx` finds matches
6. TypeScript compiles: `cd enterprise-work-assistant/src && npx tsc --noEmit` passes
</verification>

<success_criteria>
- BriefingCard.tsx has zero plain HTML interactive elements (button, a, input) ‚Äî all replaced with Fluent UI
- ConfidenceCalibration.tsx has zero plain HTML button elements ‚Äî all replaced with Fluent UI
- ConfidenceCalibration uses TabList/Tab for tab navigation instead of manual className toggling
- BriefingCard has optional onBack prop and renders Back button when provided (UIUX-05)
- Empty analytics buckets show "No data" instead of "0%" (UIUX-06)
- All 10+ existing BriefingCard tests pass
- All 15+ existing ConfidenceCalibration tests pass
</success_criteria>

<output>
After completion, create `.planning/phases/16-fluent-ui-migration-ux-polish/16-01-SUMMARY.md`
</output>
